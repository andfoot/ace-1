<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    <title>贵州新农合运行情况</title>

    <link rel="shortcut icon" href="../asset/ico/favicon.png">

    <link href="../asset/css/font-awesome.min.css" rel="stylesheet">
    <link href="../asset/css/bootstrap.css" rel="stylesheet">
    <link href="../asset/css/carousel.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="./www/js/echarts.js"></script>

   

	
</head>

<body>
   

    <div id="main" style="height: 630px;"></div>
                <div>
                   
                    <select id="theme-select"></select>

                    <span id='wrong-message' style="color:red"></span>
                </div>

   
    <script src="../asset/js/jquery.min.js"></script>
    
    <script src="../asset/js/bootstrap.min.js"></script>
    <script>
    	var cityMap = {
    "贵阳市": "520100",
    "六盘水市": "520200",
    "遵义市": "520300",
    "安顺市": "520400",
    "毕节地区": "520500",
    "黔西南布依族苗族自治州": "522300",
    "黔东南苗族侗族自治州": "522600",
    "黔南布依族苗族自治州": "522700" 
};
var curIndx = 0;
var mapType = [];
var mapGeoData={};


var option = {
	 backgroundColor: '#1b1b1b',
    title: {
        text : '贵州新农合运行情况',
        subtext : '贵州2015.01-2015.08（滚轮或点击切换）'
    },
    tooltip : {
        trigger: 'item',
       formatter:'{b}<br>参合人员：{c0}万<br>统筹资金使用：{e}百万'
    },
    legend: {
        orient: 'vertical',
        x:'right',
        data:['随机数据']
    },
    dataRange: {
        min: 0,
        max: 1000,
        color:['orange','yellow'],
        text:['高','低'],           // 文本，默认为数值文本
        calculable : true
    },
    series : [
        {
            name: '随机数据',
            type: 'map',
            mapType: '贵州',
            selectedMode : 'single',
           // roam:true,
            itemStyle:{
                normal:{label:{show:true}},
                emphasis:{label:{show:true}}
            },
            data:[
                {name: '遵义市',value: 10},
                {name: '黔东南苗族侗族自治州',value: 20},
                {name: '毕节地区',value: 30},
                {name: '黔南布依族苗族自治州',value: 40},
                {name: '铜仁地区',value: 50},
                {name: '黔西南布依族苗族自治州',value:60},
                {name: '六盘水市',value: 70},
                {name: '安顺市',value:80},
                {name: '贵阳市',value: 90}  
            ],
                   markLine : {
	                 smooth:true,
                symbol: ['none', 'circle'],  
                symbolSize : 1,
                effect : {
                    show: true,
                    scaleSize: 1,
                    period: 30,
                    color: '#fff',
                    shadowBlur: 10
                },
                itemStyle : {
                    normal: {
                        color:'#fff',
                        borderWidth:1,
                        borderColor:'rgba(30,144,255,0.5)',
                        label: {
                            show: true,
                            formatter:'\n\r\n\r\n\r\n\r{c}',
                            textStyle:{
                            	color:'blue',
                            fontSize:12,
                            fontWeight:100,
                            align:'left' 
                            	}
                            
                        }
                    }
                },
             
	                data : [
	                    [{name:'六盘水市',value:950},{name:'遵义市'} ],
	                    [{name:'遵义市',value:900},{name:'贵阳市'}],
	                    [{name:'铜仁地区',value:800},{name:'六盘水市'}],
	                    [{name:'毕节地区',value:700},{name:'铜仁地区'}],
	                    [{name:'六盘水市',value:600},{name:'贵阳市'}],
	                    [{name:'安顺市',value:500},{name:'铜仁地区'}],
	                    [{name:'黔南布依族苗族自治州',value:400},{name:'六盘水市'}],
	                    [{name:'黔东南苗族侗族自治州',value:300},{name:'贵阳市'}],
	                    [{name:'遵义市',value:200},{name:'遵义市'}]
	                ]
	            },
              markPoint : {
                symbolSize: 30, 
                 textColor:'red',
                symbol:'emptyRectangle', 
                   // 标注大小，半宽（半径）参数，当图形为方向或菱形则总宽度为symbolSize * 2
                itemStyle: {
                    normal: {
                        borderColor: '#87cefa',
                       
                        borderWidth: 0,            // 标注边线线宽，单位px，默认为1
                        label: {
                            show: true,
                            formatter:'{c}\n\r\n\r',
                            textStyle:{
                            	color:'red',
                            fontSize:18,
                            fontWeight:800
                            	}
                            
                        }
                    },
                    emphasis: {
                        borderColor: '#1e90ff',
                        borderWidth: 0,
                        label: {
                            show: true,
                             formatter:'{c}\n\r\n\r',
                            textStyle:{
                            	color:'red',
                            fontSize:18,
                            fontWeight:800
                            	}
                            
                        }
                    }
                },
                data : [
                 {name: '遵义市',value: 1},
                {name: '黔东南苗族侗族自治州',value: 2},
                {name: '毕节地区',value: 3},
                {name: '黔南苗族布依族自治州',value: 4},
                {name: '铜仁地区',value: 5},
                {name: '黔西南苗族布依族自治州',value:6},
                {name: '六盘水市',value: 7},
                {name: '安顺市',value:8},
                {name: '贵阳市',value: 9}  
                ]
            },
               geoCoord: {
                '贵阳市': [106.6992,26.7682],
	                '六盘水市': [104.8727953,26.5821372],
                    '遵义市': [106.9090748,27.6583199],
                    '铜仁地区': [108.50,27.90],
                    '毕节地区': [105.18,27.18],
                    '安顺市': [105.55,26.14],
                    '黔南布依族苗族自治州': [107.5112951,26.2830359],
                    '黔东南苗族侗族自治州': [107.9810035,26.5830679],
                     '黔西南布依族苗族自治州':[104.8948967,25.093547]
            }
            
        }
    ]
};

function initMyChart(){
	    var ecConfig = require('echarts/config');
var zrEvent = require('zrender/tool/event');
var curIndx = 0;
var mapType = [];
var mapGeoData = require('echarts/util/mapData/params');
for (var city in cityMap) {
    mapType.push(city);
    // 自定义扩展图表类型
    mapGeoData.params[city] = {
        getGeoJson: (function (c) {
            var geoJsonName = cityMap[c];
            return function (callback) {
                $.getJSON('geoJson/china-main-city/' + geoJsonName + '.json', callback);
            }
        })(city)
    }
}

document.getElementById('main').onmousewheel = function (e){
    var event = e || window.event;
    curIndx += zrEvent.getDelta(event) > 0 ? (-1) : 1;
    if (curIndx < 0) {
        curIndx = mapType.length - 1;
    }
    var mt = mapType[curIndx % mapType.length];
    option.series[0].mapType = mt;
    option.title.subtext = mt + ' （滚轮或点击切换）';
    myChart.setOption(option, true);
    zrEvent.stop(event);
};
myChart.on(ecConfig.EVENT.MAP_SELECTED, function (param){
	
    var mt = param.target;
    var len = mapType.length;
    console.log(mt);
    var f= false;
    for(var i=0;i<len;i++){
        if(mt == mapType[i]){
              f =true;
              mt=mapType[i];
        }
     }
  if(!f){
    mt='贵州';
  }
    option.series[0].mapType = mt;
     
    option.title.subtext = mt + ' （滚轮或点击切换）';
    myChart.setOption(option, true);
});

setInterval("myInterval()",3000);//1000为1秒钟

//下钻地区



	}
	
	
function GetRandomNum(Min,Max){   
var Range = Max - Min;   
var Rand = Math.random();   
return(Min + Math.round(Rand * Range));   
} 
function myInterval(){
	option.series[0].markPoint.data=[
                {name: '遵义市',value: GetRandomNum(235,8788)},
                {name: '黔东南苗族侗族自治州',value: GetRandomNum(235,8788)},
                {name: '毕节地区',value: GetRandomNum(235,8788)},
                {name: '黔南布依族苗族自治州',value: GetRandomNum(235,8788)},
                {name: '铜仁地区',value: GetRandomNum(235,8788)},
                {name: '黔西南布依族苗族自治州',value:GetRandomNum(235,8788)},
                {name: '六盘水市',value: GetRandomNum(235,8788)},
                {name: '安顺市',value:GetRandomNum(235,8788)},
                {name: '贵阳市',value: GetRandomNum(235,8788)}  
            ];
            console.log(myChart.getOption().series[0].markPoint.data);
            //myChart.refresh();
            myChart.setOption(option,true);
	}
    	</script>
    <script>
    	var myChart;

var domMain = document.getElementById('main');
var domMessage = document.getElementById('wrong-message');

var needRefresh = false;

var enVersion = location.hash.indexOf('-en') != -1;
var hash = location.hash.replace('-en','');
hash = hash.replace('#','') || (needMap() ? 'default' : 'macarons');
hash += enVersion ? '-en' : '';

var curTheme;
function requireCallback (ec, defaultTheme) {
    curTheme = themeSelector ? defaultTheme : {};
    echarts = ec;
    refresh();
    window.onresize = myChart.resize;
}

var themeSelector = $('#theme-select');
if (themeSelector) {
    themeSelector.html(
        '<option selected="true" name="macarons">macarons</option>'
        + '<option name="infographic">infographic</option>'
        + '<option name="shine">shine</option>'
        + '<option name="dark">dark</option>'
        + '<option name="blue">blue</option>'
        + '<option name="green">green</option>'
        + '<option name="red">red</option>'
        + '<option name="gray">gray</option>'
        + '<option name="helianthus">helianthus</option>'
        + '<option name="roma">roma</option>'
        + '<option name="mint">mint</option>'
        + '<option name="macarons2">macarons2</option>'
        + '<option name="sakura">sakura</option>'
        + '<option name="default">default</option>'
    );
    $(themeSelector).on('change', function(){
        selectChange($(this).val());
    });
    function selectChange(value){
        var theme = value;
        myChart.showLoading();
        $(themeSelector).val(theme);
        if (theme != 'default') {
            window.location.hash = value + (enVersion ? '-en' : '');
            require(['theme/' + theme], function(tarTheme){
                curTheme = tarTheme;
                setTimeout(refreshTheme, 500);
            })
        }
        else {
            window.location.hash = enVersion ? '-en' : '';
            curTheme = {};
            setTimeout(refreshTheme, 500);
        }
    }
    function refreshTheme(){
        myChart.hideLoading();
        myChart.setTheme(curTheme);
    }
    if ($(themeSelector).val(hash.replace('-en', '')).val() != hash.replace('-en', '')) {
        $(themeSelector).val('macarons');
        hash = 'macarons' + enVersion ? '-en' : '';
        window.location.hash = hash;
    }
}

function autoResize() {
    if ($(iconResize).hasClass('glyphicon-resize-full')) {
        focusCode();
        iconResize.className = 'glyphicon glyphicon-resize-small';
    }
    else {
        focusGraphic();
        iconResize.className = 'glyphicon glyphicon-resize-full';
    }
}

function focusCode() {
    domCode.className = 'col-md-8 ani';
    domGraphic.className = 'col-md-4 ani';
}

function focusGraphic() {
    domCode.className = 'col-md-4 ani';
    domGraphic.className = 'col-md-8 ani';
    if (needRefresh) {
        myChart.showLoading();
        setTimeout(refresh, 1000);
    }
}



function refresh(isBtnRefresh){
    if (isBtnRefresh) {
        needRefresh = true;
        focusGraphic();
        return;
    }
    needRefresh = false;
    if (myChart && myChart.dispose) {
        myChart.dispose();
    }
    myChart = echarts.init(domMain, curTheme);
    window.onresize = myChart.resize;
    //(new Function(editor.doc.getValue()))();
    //--------------------------------------------------------
initMyChart();

    //-----------------------------------------------------
    myChart.setOption(option, true)
   
}

function needMap() {
    var href = location.href;
    return href.indexOf('map') != -1
           || href.indexOf('mix3') != -1
           || href.indexOf('mix5') != -1
           || href.indexOf('dataRange') != -1;

}

var echarts;
var developMode = false;

if (developMode) {
    window.esl = null;
    window.define = null;
    window.require = null;
    (function () {
        var script = document.createElement('script');
        script.async = true;

        var pathname = location.pathname;

        var pathSegs = pathname.slice(pathname.indexOf('doc')).split('/');
        var pathLevelArr = new Array(pathSegs.length - 1);
        script.src = pathLevelArr.join('../') + 'asset/js/esl/esl.js';
        if (script.readyState) {
            script.onreadystatechange = fireLoad;
        }
        else {
            script.onload = fireLoad;
        }
        (document.getElementsByTagName('head')[0] || document.body).appendChild(script);
        
        function fireLoad() {
            script.onload = script.onreadystatechange = null;
            setTimeout(loadedListener,100);
        }
        function loadedListener() {
            // for develop
            require.config({
                packages: [
                    {
                        name: 'echarts',
                        location: '../../src',
                        main: 'echarts'
                    },
                    {
                        name: 'zrender',
                        // location: 'http://ecomfe.github.io/zrender/src',
                        location: '../../../zrender/src',
                        main: 'zrender'
                    }
                ]
            });
            launchExample();
        }
    })();
}
else {
    // for echarts online home page
    require.config({
        paths: {
            echarts: './www/js'
        }
    });
    launchExample();
}

var isExampleLaunched;
function launchExample() {
    if (isExampleLaunched) {
        return;
    }

    // 按需加载
    isExampleLaunched = 1;
    require(
        [
            'echarts',
            'theme/' + hash.replace('-en', ''),
            'echarts/chart/line',
            'echarts/chart/bar',
            'echarts/chart/scatter',
            'echarts/chart/k',
            'echarts/chart/pie',
            'echarts/chart/radar',
            'echarts/chart/force',
            'echarts/chart/chord',
            'echarts/chart/gauge',
            'echarts/chart/funnel',
            'echarts/chart/eventRiver',
            'echarts/chart/venn',
            'echarts/chart/treemap',
            'echarts/chart/tree',
            'echarts/chart/wordCloud',
            needMap() ? 'echarts/chart/map' : 'echarts'
        ],
        requireCallback
    );
}


    	</script>
</body>
</html>
